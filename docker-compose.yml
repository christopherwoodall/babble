services:
  splunk:
    image: splunk/splunk:latest

    environment:
      - SPLUNK_START_ARGS=--accept-license
      # Install the required apps from local and remote(Splunkbase) repositories:
      #   - Add-on for Stream Forwarders (5238)
      #   - TA for Zeek (5466)
      - SPLUNK_APPS_URL=https://api.splunkbase.splunk.com/api/v2/apps/5238/releases/8.1.0/download/?origin=sb&lead=true,https://api.splunkbase.splunk.com/api/v2/apps/5466/releases/1.0.5/download/?origin=sb&lead=true
      - SPLUNKBASE_USERNAME=${SPLUNKBASE_USER}
      - SPLUNKBASE_PASSWORD=${SPLUNKBASE_PASS}
      - SPLUNK_USER=root
      - SPLUNK_PASSWORD=changeme
      - DEBUG=true

    volumes:
      - ./data:/data:z
      - ./data/splunk/var:/opt/splunk/var:z
      - ./data/splunk/etc:/opt/splunk/etc:z
      # - ./data/splunk/etc/splunk-launch.conf:/opt/splunk/etc/splunk-launch.conf:z
      # - ./data/splunk/etc/apps/Splunk_TA_stream/local/streamfwd.conf:/opt/splunk/etc/apps/Splunk_TA_stream/local/streamfwd.conf:z

    ports:
      - 8000:8000


  # TODO: Add a container for app
  # babble:
  #   image: python:3.10


# NOTES:
#  - https://splunk.github.io/docker-splunk/advanced/APP_INSTALL.html#volume-mount-app-directory
#
